class Fibre{constructor(t,e){this.i=e,this.brush=t,this.fibreLengthNoise=.2,this.fibreOpacityNoise=.3,this.sizeStrokeFibre=t.area.sizeStroke+getRandomFromInterval(-t.area.fibreStrokeSizeNoise,t.area.fibreStrokeSizeNoise),this.startX=t.brushPosX+noise(this.i*this.fibreLengthNoise)*t.area.fibreStartLengthNoise-t.area.fibreStartLengthNoise,this.startY=t.brushPosY+noise(this.i*this.fibreLengthNoise)*t.area.fibreStartLengthNoise-t.area.fibreStartLengthNoise,"horizontal"==t.area.orientation?this.stop=t.brushPosX+t.brushLength_+noise(this.i*this.fibreLengthNoise)*t.area.fibreStartLengthNoise:"vertical"==t.area.orientation&&(this.stop=t.brushPosY+t.brushLength_+noise(this.i*this.fibreLengthNoise)*t.area.fibreStartLengthNoise),this.colorFibre=brightenColor(distortColor(color(t.colorBrush),t.area.fibreColorNoise),t.area.fibreBrightnessNoise),this.colorFibre=color(red(this.colorFibre),green(this.colorFibre),blue(this.colorFibre),noise(this.i*this.fibreOpacityNoise)*(255-t.area.fibreOpacityNoiseBase)+t.area.fibreOpacityNoiseBase),this.angleFibre=t.angle+getRandomFromInterval(-t.area.fibreRotationNoise,t.area.fibreRotationNoise)}}class Brush{constructor(t,e,i,s){this.area=t,this.brushPosX=e,this.brushPosY=i,this.colorBrush=brightenColor(distortColor(color(this.area.colorObject),this.area.colorNoise),this.area.brightnessNoise),this.brushLength_=this.area.brushLength+getRandomFromInterval(-this.area.brushLength*this.area.brushLengthNoise,this.area.brushLength*this.area.brushLengthNoise),this.numberFibres_=this.area.numberFibres+getRandomFromInterval(-this.area.numberFibres*this.area.brushBreadthNoise,this.area.numberFibres*this.area.brushBreadthNoise),this.angle=getRandomFromInterval(-this.area.brushAngleNoise,this.area.brushAngleNoise),this.fibres=[],s>0&&fxrand()>.85&&"horizontal"==this.area.orientation&&(this.brushPosX=getRandomFromInterval(this.area.overlap/2,this.area.custom_width-this.brushLength_-this.area.overlap/2),this.brushPosY=getRandomFromInterval(this.area.overlap/2,this.area.custom_height-this.numberFibres_*this.area.sizeStroke-this.area.overlap/2)),s>0&&fxrand()>.85&&"vertical"==this.area.orientation&&(this.brushPosX=getRandomFromInterval(this.area.overlap/2,this.area.custom_width-this.numberFibres_*this.area.sizeStroke-this.area.overlap/2),this.brushPosY=getRandomFromInterval(this.area.overlap/2,this.area.custom_height-this.brushLength_-this.area.overlap/2)),noiseSeed(NOISESEED+10*fxrand());for(var r=0;r<this.numberFibres_;r++)this.fibres.push(new Fibre(this,r));noiseSeed(NOISESEED)}}class PaintBrushArea{constructor(t){if(void 0===t&&(t={custom_width:600,custom_height:400,posX:-100,posY:-100,colorObject:color1,orientation:"vertical",brushLength:30,brushBreadth:30,sizeStroke:2,numberPaintLayers:2,overlap:20,brightnessNoise:5,colorNoise:5,opacityBoost:0,brushLengthNoise:.2,brushBreadthNoise:.2,brushAngleNoise:PI/20,fibreColorNoise:2,fibreBrightnessNoise:2,fibreStrokeSizeNoise:1,fibreStartLengthNoise:15,fibreBreadthNoise:.5,fibreRotationNoise:PI/200,fibreOpacityNoiseBase:150}),this.custom_width=t.custom_width,this.custom_height=t.custom_height,this.posX=t.posX,this.posY=t.posY,this.colorObject=color(t.colorObject),this.orientation=t.orientation,this.brushLength=t.brushLength,this.brushBreadth=t.brushBreadth,this.sizeStroke=t.sizeStroke,this.numberPaintLayers=t.numberPaintLayers,this.overlap=t.overlap,this.brightnessNoise=t.brightnessNoise,this.colorNoise=t.colorNoise,this.opacityBoost=t.opacityBoost,this.brushLengthNoise=t.brushLengthNoise,this.brushBreadthNoise=t.brushBreadthNoise,this.brushAngleNoise=t.brushAngleNoise,this.fibreColorNoise=t.fibreColorNoise,this.fibreBrightnessNoise=t.fibreBrightnessNoise,this.fibreStrokeSizeNoise=t.fibreStrokeSizeNoise,this.fibreStartLengthNoise=t.fibreStartLengthNoise,this.fibreBreadthNoise=t.fibreBreadthNoise,this.fibreRotationNoise=t.fibreRotationNoise,this.fibreOpacityNoiseBase=t.fibreOpacityNoiseBase,"horizontal"==this.orientation){var e=Math.round(this.custom_width/this.brushLength);this.brushLength=this.custom_width/e;var i=Math.round(this.custom_height/this.brushBreadth);this.brushBreadth=this.custom_height/i}else"vertical"==this.orientation&&(i=Math.round(this.custom_height/this.brushBreadth),this.brushLength=this.custom_height/i,e=Math.round(this.custom_width/this.brushLength),this.brushBreadth=this.custom_width/e);this.numberFibres=this.brushBreadth/this.sizeStroke,this.brushStrokes=[],this.createBrushes()}createBrushes(){for(let t=0;t<this.numberPaintLayers;t+=1)if("horizontal"==this.orientation)for(let e=0;e<this.custom_width;e+=this.brushLength)for(let i=0;i<this.custom_height;i+=this.brushBreadth)this.brushStrokes.push(new Brush(this,e,i,t));else if("vertical"==this.orientation)for(let e=0;e<this.custom_height;e+=this.brushLength)for(let i=0;i<this.custom_width;i+=this.brushBreadth)this.brushStrokes.push(new Brush(this,i,e,t))}show(){for(var t of this.brushStrokes){for(var e of(1==GRIDVISIBLE&&(buffer.push(),buffer.strokeWeight(1),buffer.stroke(color(20,50)),buffer.noFill(),buffer.translate((this.posX-this.custom_width/2+t.brushPosX)/exportRatio,(this.posY-this.custom_height/2+t.brushPosY)/exportRatio),buffer.rect(0,0,this.brushLength/exportRatio,this.brushBreadth/exportRatio),buffer.pop()),t.fibres))buffer.push(),"horizontal"==this.orientation?(buffer.translate((this.posX-this.custom_width/2+e.startX)/exportRatio,(this.posY-this.custom_height/2+t.brushPosY)/exportRatio),buffer.rotate(e.angleFibre)):"vertical"==this.orientation&&(buffer.translate((this.posX-this.custom_width/2+t.brushPosX)/exportRatio,(this.posY-this.custom_height/2+e.startY)/exportRatio),buffer.rotate(e.angleFibre/PI/2)),buffer.stroke(e.colorFibre),buffer.strokeWeight(e.sizeStrokeFibre),exportRatio,buffer.noFill(),"horizontal"==this.orientation?buffer.line(0,this.sizeStroke*e.i/exportRatio,(e.stop-e.startX)/exportRatio,this.sizeStroke*e.i/exportRatio):"vertical"==this.orientation&&buffer.line(this.sizeStroke*e.i/exportRatio,0,this.sizeStroke*e.i/exportRatio,(e.stop-e.startY)/exportRatio),buffer.pop();logging.getLevel()<=1&&(buffer.push(),buffer.strokeWeight(1),exportRatio,buffer.noFill(),buffer.translate((this.posX-this.custom_width/2+t.brushPosX)/exportRatio,(this.posY-this.custom_height/2+t.brushPosY)/exportRatio),buffer.rect(0,0,this.brushLength/exportRatio,this.brushBreadth/exportRatio),buffer.pop())}logging.getLevel()<=1&&(buffer.push(),buffer.rectMode(CENTER),buffer.fill("purple"),buffer.translate(this.posX/exportRatio,this.posY/exportRatio),buffer.rect(0,0,this.custom_width/exportRatio,this.custom_height/exportRatio),buffer.pop())}}